---
name: CI
run-name: CI triggered from @${{ github.actor }} of ${{ github.head_ref }}

concurrency:
  group: ${{ github.workflow }}-${{ github.ref }}
  cancel-in-progress: true

on:
  workflow_dispatch:
  pull_request:

jobs:
  go-tests:
    uses: ./.github/workflows/_go-tests.yml
    secrets: inherit
    permissions:
      pull-requests: write

  can_proceed:
    name: can_proceed
    runs-on: ubuntu-4
    needs: [go-tests]
    steps:
      - name: OK
        run: exit 0

  can_see_status:
    # This job is just to make sure that the "can_proceed" job's status is visible
    # on the pull request page, even if it is skipped due to all its dependencies being
    # skipped. It does not depend on any other jobs, so it always runs.
    runs-on: ubuntu-4
    steps:
      - run: true
